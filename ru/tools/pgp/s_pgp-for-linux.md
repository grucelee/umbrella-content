---
index: 10
title: PGP для Linux
---
# РУКОВОДСТВО К ИНСТРУМЕНТУ PGP ДЛЯ LINUX

## Руководство к инструменту PGP для Linux
Зашифрованная электронная почта для Linux

**Урок для чтения: [E-mail](umbrella://communications/email)**  
**Требования к компьютеру:** Интернет-соединение, компьютер под управлением Linux, e-mail аккаунт  
**Версия, используемая в этом руководстве:**  
- Linux: Debian 7.0 ("Wheezy")  
- Mozilla Thunderbird 24.8.1  
- Enigmail 1.6  
- GPG4Win 1.4.18

**Лицензия:** Бесплатное ПО; сочетание лицензий на бесплатное программное обеспечение  
**Уровень:** Эксперт  
**Дополнительное чтение:** [https://www.gnupg.org/documentation/guides.html](https://www.gnupg.org/documentation/guides.html)  
**Требуемое время:** 30-60 минут  

**Использование PGP даст вам:**
- Способность защитить ваши e-mail сообщения от прочтения кем-либо, кроме предполагаемых получателей.
- Возможность доказать, что электронное письмо пришло от определенного человека, а не является поддельным сообщением, отправленным другим отправителем (в противном случае e-mail очень легко подделать). Оба из них являются важной защитой, если вы подвергаетесь преследованию или дезинформации.

**Примечание:** Если вы обеспокоены тем, что электронная почта, зашифрованная PGP, может быть небезопасной после того, как в мае 2018 года были обнаружены уязвимости, прочитайте раздел Efail нашего урока [E-mail уровня Продвинутый](umbrella://communications/email).

### 1.0 Прежде чем начать

Чтобы использовать Pretty Good Privacy (PGP), вам нужно установить дополнительное программное обеспечение, которое будет работать с вашей текущей почтовой программой. Вам также нужно будет создать закрытый ключ, который вы будете хранить в секрете. Закрытый ключ - это то, что вы будете использовать для расшифровки отправленных вам электронных писем, а также для цифровой подписи отправляемых вами электронных писем, чтобы показать, что они действительно пришли от вас. Наконец, вы узнаете, как распространять ваш открытый ключ - небольшой фрагмент информации, который другие должны будут знать, прежде чем они смогут отправлять вам зашифрованные письма, и который они могут использовать для проверки отправляемых вами электронных писем.

Это руководство покажет вам, как использовать PGP с операционной системой Linux, используя Mozilla Thunderbird, популярный почтовый клиент с открытым исходным кодом.

В настоящее время вы не можете использовать PGP напрямую с сервисами e-mail, такими как Gmail, Hotmail, Yahoo! Mail или Outlook Live. Вы все еще можете использовать свой адрес электронной почты; вам просто нужно настроить его с помощью программы Thunderbird на вашем компьютере.

**Обратите внимание, что для работы обоих отправителей/получателей электронной почты необходимо использовать PGP-совместимое программное обеспечение.**

Люди обычно используют это только на своих личных устройствах, а не на общих устройствах. К счастью, PGP доступен для большинства настольных компьютеров и мобильных устройств, и вы можете другим им эти руководства, чтобы помочь им настроить свою собственную версию.

### 2.0 Установка Thunderbird, GnuPG и Enigmail

PGP - это открытый стандарт, который означает, что его может использовать разное программное обеспечение. Программное обеспечение, которое мы собираемся использовать для PGP, называется GnuPG. Мы также добавим плагин для Thunderbird под названием Enigmail, который позволит вам использовать GnuPGP вThunderbird. Следующие инструкции требуют некоторого комфорта в работе с командной строкой.

Если вы используете дистрибутив Red Hat, такой как Red Hat или Fedora Core, откройте терминал и выполните следующие команды:

_sudo yum install gnupg thunderbird thunderbird-enigmail_

Если вы используете дистрибутив на основе Ubuntu, такой как Ubuntu или Linux Mint, откройте терминал и введите эти команды, чтобы убедиться, что у вас установлено правильное программное обеспечение:

_sudo apt-get install gnupg thunderbird enigmail_

Если вы используете дистрибутив Debian, вы обнаружите, что Thunderbird называется «Icedove». Как и Debian в целом, это установлено по вполне разумным, но несколько неясным причинам. Помимо названия, это точно такая же программа: мы не будем больше упоминать Icedove, но вы можете просто заменить «Thunderbird» на Icedove в оставшейся части этого руководства, и все должно работать.

Используйте эту команду в Терминале для установки:

_sudo apt-get install gnupg icedove enigmail_

### 2.1 Настройка Thunderbird

Теперь, когда вы установили Thunderbird, откройте его так же, как и другое приложение на вашем компьютере (вы можете выбрать его из списка приложений в меню или ввести его имя в поиске приложений). Вы увидите мастер первого запуска.

![image](tool_pgplin1.png)

Чтобы настроить существующий адрес e-mail, нажмите «Пропустить и использовать мою существующую электронную почту», а затем введите свое имя, адрес e-mail и пароль для своего e-mail аккаунта.

![image](tool_pgplin2.png)

Если вы используете популярный бесплатный почтовый сервис, такой как Gmail, Thunderbird сможет автоматически определить ваши настройки электронной почты, когда вы нажмете «Продолжить».

**Если вы используете двухфакторную аутентификацию в Google (и, в зависимости от модели угрозы, вам, вероятно, следует!), Вы не можете использовать свой стандартный пароль Gmail в Thunderbird. Вместо этого вам нужно будет создать новый пароль для приложения, чтобы Thunderbird мог получить доступ к вашей учетной записи Gmail.  для этого смотрите [Собственное руководство Google](https://support.google.com/mail/answer/1173270?hl=en).**

![image](tool_pgplin2.png)

Если этого не произойдет, вам может потребоваться вручную настроить параметры IMAP и SMTP. Если вы не знаете, как это сделать, поговорите с вашим e-mail провайдером или попросите кого-нибудь, кто знаком с вашим e-mail провайдером (например, ИТ-специалист на работе или опытный друг, который использует тот же ISP, что и вы; им не нужно знать, как использовать PGP, но вы можете спросить их: «Известны ли вам настройки IMAP и SMTP для моего адреса электронной почты?»).

### 2.2 Настройка Enigmail

Enigmail - это плагин для Thunderbird, который шифрует и дешифрует электронные письма, закодированные в PGP, и немного упрощает обработку закрытых и открытых ключей. Если у вас установлена последняя версия Enigmail, вам должен быть представлен мастер установки Enigmail.

![image](tool_pgplin4.png)

Если вы его не видите, вы можете найти этот пункт меню в Thunderbird. Чтобы он появился нажмите на три горизонтальные линии («меню-гамбургер») справа в окне Thunderbird. 

![image](tool_pgplin5.png)

Вот первая опция, которую предлагает вам Enigmail: три варианта работы, когда шифровать вашу почту.

![image](tool_pgplin6.png)

По умолчанию используется шифрование электронной почты, если у вас есть «открытый ключ» другого человека, Enigmail зашифрует отправляемую вами почту, но оставит письма незашифрованными, если у вас еще нет открытого ключа получателя. У вас также есть возможность постоянно шифровать электронные письма всем с помощью ключей PGP, а это значит, что вам придется находить открытые ключи для людей, для которых у вас их еще нет, или полностью отключить автоматическое шифрование и использовать PGP только для отдельных нужд.

Мы не знаем, какой вариант подходит вам, но считаем, что вариант «Совместимое автоматическое шифрование» является хорошим выбором. Если у вас есть сомнения, выберите «Не шифровать мои сообщения по умолчанию».

Нажмите кнопку «Далее».

![image](tool_pgplin6.png)

Теперь у вас есть возможность цифровой подписи всех исходящих писем. Подписание электронной почты с помощью PGP позволяет получателю проверить, что именно вы отправили данное сообщение и что содержимое сообщения не было подделано. Нажмите кнопку «Подписывать мои сообщения по умолчанию», чтобы включить эту функцию.

Недостатком этого является, однако, то, что он также может показать любому, что вы используете PGP. [В некоторых частях мира](www.cryptolaw.org/) (включая Китай, Иран, Беларусь и некоторые государства Ближнего Востока) использование нелицензионного шифрования, даже для личного использования, является незаконным, поэтому у вас могут быть веские причины чтобы другие не знали, что вы используете PGP.

Нажмите кнопку «Далее».

Теперь вы увидите, что Enigmail может внести некоторые изменения в конфигурацию Mozilla Thunderbird. 

![image](tool_pgplin7.png)

Если вы нажмете кнопку Подробности, вы сможете просмотреть, что это за изменения.

Следующие параметры можно отключить (включить) для более плавного перехода, если вы по умолчанию используете PGP / Mime (мы установим это позже)
- Отключите потоковый текст
- Просматривать тело сообщения как обычный текст
- Не пишите HTML-сообщения

Последний вариант предотвращает возможные проблемы с шифрованием и дешифрованием вашей электронной почты. Имейте в виду, что выбор этого поля удалит возможность отправлять текст, выделенный жирным шрифтом, подчеркнутый или цветной. Ознакомившись с изменениями, нажмите кнопку «ОК».

Теперь вы начнете создавать свой закрытый ключ и открытый ключ.

### 2.3 Создание открытого и закрытого ключей

Установка и настройка дополнения Enigmail завершена. Теперь у вас будет возможность создать пару открытого и закрытого ключей. Предполагается, что вы ранее не создавали закрытый ключ.

![image](tool_pgplin8.png)

Нажмите "Далее".

Если вы уже настроили более одного e-mail аккаунта, Enigmail может выбрать учетную запись из уже настроенных. Первое, что вам нужно сделать, это придумать надежную фразу-пароль для вашего закрытого ключа. См. **[урок Пароли](umbrella://information/passwords)** для получения дополнительной информации о том, как это сделать.

Enigmail отобразит некоторую информацию о вашем закрытом ключе, а также о настройках конфигурации. Мы рекомендуем создавать ключи длиной 4096 бит. Нажмите кнопку «Далее». 

![image](tool_pgplin9.png)

**Срок действия вашего ключа истекает в определенное время; когда это произойдет, другие люди полностью перестанут использовать его для новых писем, хотя вы можете не получить никакого предупреждения или объяснения причин. Таким образом, вы можете отметить в своем календаре и обратить внимание на этот вопрос примерно за месяц до истечения срока действия.**

Можно продлить срок действия существующего ключа, задав ему новый, более поздний срок действия, или можно заменить его новым ключом, создав новый с нуля. Для обоих процессов может потребоваться связаться с людьми, которые пишут вам по электронной почте, и убедиться, что они получили обновленный ключ; текущее программное обеспечение не очень хорошо автоматизирует это. Так что сделайте напоминание для себя; если вы не думаете, что сможете управлять им, вы можете установить ключ так, чтобы он никогда не истекал, хотя в этом случае другие люди могут попытаться использовать его, чтобы связаться с вами в будущем, даже если вы больше не будете иметь закрытый ключ или больше не использовать PGP.

Enigmail сгенерирует ключ, и когда процесс будет завершен, откроется небольшое окно с просьбой сгенерировать сертификат отзыва. Важно иметь этот сертификат отзыва, поскольку он позволяет сделать закрытый ключ и открытый ключ недействительными. Важно отметить, что простое удаление закрытого ключа не делает недействительным открытый ключ и может привести к тому, что люди отправят вам зашифрованную почту, которую вы не сможете расшифровать.

![image](tool_pgplin10.png)

Нажмите кнопку «Создать сертификат».

Откроется окно, чтобы предоставить вам место для сохранения сертификата отзыва. Несмотря на то, что вы можете сохранить файл на своем компьютере, мы рекомендуем сохранить файл на USB-накопителе, который вы не используете ни для чего другого, и хранить его в безопасном месте. Мы также рекомендуем удалить сертификат отзыва с компьютера с ключами, чтобы избежать непреднамеренного отзыва.

Еще лучше сохранить этот файл на отдельном зашифрованном диске. Выберите место, где вы сохраните этот файл, и нажмите кнопку «Сохранить».

Теперь Enigmail предоставит вам дополнительную информацию о сохранении файла сертификата отзыва еще раз. Нажмите кнопку «ОК».

Наконец, вы закончили с генерацией закрытого ключа и открытого ключа. Нажмите кнопку «Готово».

### 2.4 Необязательные шаги

### 2.4.1 Отображение длинных ключей

Следующие шаги не являются обязательными, но могут быть полезны при использовании OpenPGP и Enigmail. Вкратце, идентификатор ключа - это небольшая часть отпечатка. Когда дело доходит до проверки того, что открытый ключ принадлежит конкретному человеку, лучше всего использовать отпечатки. Изменение дисплея по умолчанию облегчает чтение отпечатков сертификатов, о которых вы знаете. Нажмите кнопку конфигурации, затем опцию Enigmail, затем Управление ключами. 

![image](tool_pgplin11.png)

Откроется окно с двумя столбцами: Имя и Идентификатор ключа. 

![image](tool_pgplin12.png)

Справа есть маленькая кнопка. Нажмите эту кнопку, чтобы настроить столбцы. Снимите флажок «Идентификатор ключа» и выберите «Отпечаток».

![image](tool_pgplin13.png)

Теперь измените ширину столбца «Отпечаток», переместив указатель мыши на линии между заголовками каждого столбца (то есть, слева от заголовка «Идентификатор ключа» в верхней части списка ключей) и перетащите строку влево. Продолжайте двигаться влево, пока не увидите все идентификаторы ключей, например:

Теперь столбцы будут выглядеть так:

![image](tool_pgplin14.png)

Теперь вы настроены на отправку и получение обычной и зашифрованной электронной почты. Далее вы пройдете этапы поиска людей для обмена зашифрованной почтой.

**Использование PGP не позволяет полностью зашифровать вашу электронную почту, поэтому информация об отправителе и получателе не зашифрована. Шифрование информации об отправителе и получателе может привести к поломке электронной почты. Использование Thunderbird с надстройкой Enigmail дает вам простой способ зашифровать и расшифровать именно содержимое вашей электронной почты.**

### 3.0 Сообщите другим, что вы используете PGP

**а) Дайте людям знать, что вы используете PGP в электронной почте**

Вы можете легко отправить свой открытый ключ по электронной почте другому человеку, отправив ему копию в виде вложения.

Нажмите кнопку «Написать» в Mozilla Thunderbird.

Введите адрес и тему, возможно, что-нибудь вроде «мой открытый ключ», откройте меню Enigmail и выберите «Прикрепить мой открытый ключ».

![image](tool_pgplin15.png)

Теперь вы можете отправить электронное письмо, и получатель сможет загрузить и использовать открытый ключ, который вы ему отправили.

**Если используется этот метод, рекомендуется, чтобы получатель проверил отпечаток вашего открытого ключа по какой-либо другой форме связи, если электронная почта уже перехватывается и подделывается.**

**б) Дайте людям знать, что вы используете PGP через информацию на вашем сайте**

В дополнение к тому, что люди сообщают об этом по электронной почте, вы можете опубликовать свой открытый ключ на своем веб-сайте. Самый простой способ - загрузить файл и дать ссылку на него. В этом руководстве не будет рассказано, как делать эти вещи, но вы должны знать, как экспортировать сертификат в виде файла для использования в будущем.

Нажмите кнопку конфигурации, затем откройте опции Enigmail, затем выберите Управление ключами.

Выделите свой сертификат, затем щелкните правой кнопкой мыши, чтобы открыть меню, и выберите «Экспорт ключей в файл».

![image](tool_pgplin16.png)

Появится небольшое окно с тремя кнопками. Нажмите кнопку «Экспортировать только открытые ключи».

![image](tool_pgplin17.png)


**Убедитесь, что вы не нажимаете кнопку «Экспорт секретных ключей», поскольку экспорт секретного ключа может позволить другим выдать себя за вас, если они смогут угадать ваш пароль.**

Теперь откроется окно, чтобы вы могли сохранить файл. Чтобы облегчить поиск в будущем, сохраните файл в папке «Документы».

Теперь вы можете использовать этот файл по своему желанию.

**c) Загрузка на сервер ключей**

Серверы ключей облегчают поиск и загрузку открытых ключей. Большинство современных серверов ключей синхронизируются, что означает, что открытый ключ, загруженный на один сервер, в конечном итоге достигнет всех серверов.

Хотя загрузка вашего открытого ключа на сервер ключей может быть удобным способом информирования людей о том, что у вас есть открытый сертификат PGP, вы должны знать, что из-за особенностей работы серверов ключей будет невозможно удалить открытые ключи после их загрузки. Вы можете пометить их только как отозванные.

**Перед загрузкой вашего открытого ключа на сервер ключей полезно подумать, хотите ли вы, чтобы весь мир знал, что у вас есть открытый ключ без возможности удалить эту информацию позже.**

Если вы решите загрузить свой открытый ключ на сервер ключей, вы вернетесь в окно управления ключами Enigmail.

Щелкните элемент меню «Сервер ключей» и выберите параметр «Загрузка открытых ключей».

![image](tool_pgplin18.png)

### 3.1 Поиск людей, которые используют PGP

**а) Получение открытого ключа по e-mail**

Вы можете получить открытый ключ в виде вложения электронной почты.

![image](tool_pgplin19.png)

Обратите внимание на вложение в нижней части окна. Щелкните правой кнопкой мыши на вложении и выберите «Импортировать ключ OpenPGP». Откроется небольшое окно с результатами импорта. Нажмите кнопку ОК.

Если вы снова откроете окно управления ключами Enigmail, вы можете проверить результат. Ваш ключ PGP выделен жирным, поскольку у вас есть как закрытый ключ, так и открытый ключ. Открытый ключ, который вы только что импортировали, не выделен, поскольку он не содержит закрытого ключа. 

![image](tool_pgplin20.png)

**б) Получение открытого ключа в виде файла**

Возможно, вы получите открытый ключ, загрузив его с веб-сайта, или кто-то мог отправить его через программное обеспечение для чата. В таком случае вы предположите, что загрузили файл в папку «Загрузки».

Откройте диспетчер ключей Enigmail и выберите меню «Файл». Выберите «Импортировать ключи из файла».

Открытый ключ может иметь очень разные окончания имен файлов, такие как .asc, .pgp или .gpg. Выберите файл и нажмите кнопку «Открыть». Откроется небольшое окно с результатами импорта. Нажмите кнопку «ОК».

**в) Получение открытого ключа от сервера ключей**

Сервер ключей может быть очень полезным способом получения открытых ключей. Попробуйте найти открытый ключ. Откройте диспетчер ключей, затем щелкните меню «Сервер ключей» и выберите «Поиск ключей».

![image](tool_pgplin21.png)

Появится небольшое окно с полем поиска. Вы можете осуществлять поиск по полному адресу электронной почты, частичному адресу e-mail или имени. В этом случае вы будете искать сертификаты, содержащие «eff.org».

![image](tool_pgplin22.png)

Появится большее окно с большим количеством опций. Если вы прокрутите вниз, то заметите, что некоторые сертификаты выделены курсивом и выделены серым цветом. Это сертификаты, которые были либо аннулированы, либо истекли сами по себе. 

![image](tool_pgplin23.png)

Давайте возьмем, к примеру, открытые ключи Дэнни О'Брайена, у него есть один сертификат с истекшим сроком действия или отозванный сертификат и один действующий сертификат. Выберите действительный сертификат, нажав на поле слева, затем нажмите кнопку ОК.

![image](tool_pgplin24.png)

В некоторых случаях человек может иметь более одного сертификата, причем все они действительны. Обратите внимание, что любой может загрузить публичный сертификат для кого-либо другого, и что один из этих ключей может не принадлежать лицу, которому принадлежит связанный с ним адрес электронной почты. В этом случае проверка отпечатка ключа чрезвычайно важна.

Появится небольшое окно с уведомлением о том, что вам это удалось, и менеджер ключей Enigmail теперь покажет вам добавленные сертификаты:

![image](tool_pgplin25.png)

### 4.0 Отправка зашифрованной почты PGP

Теперь вы отправите свое первое зашифрованное письмо получателю. В главном окне Mozilla Thunderbird нажмите кнопку «Написать». Откроется новое окно.

Напишите ваше сообщение и введите получателя. Для этого теста выберите получателя, открытый ключ которого у вас уже есть. Enigmail обнаружит это и автоматически зашифрует письмо (вы можете сказать, что оно будет зашифровано золотым ключом в правом нижнем углу письма). 

![image](tool_pgplin26.png)

**Обратите внимание, что строка темы не будет зашифрована, поэтому выберите что-нибудь безобидное, например, "привет".**

Когда вы нажмете кнопку «Отправить», вы получите окно для ввода пароля к вашему ключу PGP. Помните, что он отличается от вашего пароля электронной почты!

Введите свой пароль, затем нажмите кнопку «ОК», и ваше письмо будет зашифровано и отправлено.

Тело письма было зашифровано и преобразовано. Например наш текст выше, был преобразован в это:

![image](tool_pgplin27.png)

### 4.1 Получение почты зашифрованной PGP

Давайте рассмотрим, что происходит, когда вы получаете зашифрованную электронную почту. Сначала нажмите на сообщение.

Откроется небольшое окно с запросом пароля для ключа PGP. Помните: это не пароль электронной почты. Нажмите кнопку «ОК».

![image](tool_pgplin28.png)

Теперь сообщение будет расшифровано

![image](tool_pgplin29.png)

### 5.0 Отзыв ключа PGP

**а) Отзыв вашего ключа PGP через интерфейс Enigmail**

Срок действия ключей PGP, сгенерированных Enigmail, автоматически истекает через пять лет. Поэтому, если вы потеряете все свои файлы, вы можете надеяться, что люди будут знать об этом, чтобы попросить вас другой ключ, как только срок действия ключа истек.

У вас может быть веская причина отключить ключ PGP до истечения срока его действия. Возможно, вы хотите сгенерировать новый, более сильный ключ PGP. Самый простой способ отозвать свой собственный ключ PGP в Enigmail - это через Enigmail Key Manager. Щелкните правой кнопкой мыши на ключе PGP (он выделен жирным) и выберите параметр «Отзыв ключа».

![image](tool_pgplin30.png)

Появится окно, сообщающее вам, что происходит, и запрашивающее ваше подтверждение. Нажмите кнопку «Отозвать ключ».

![image](tool_pgplin31.png)

Откроется окно пароля, введите пароль для ключа PGP и нажмите кнопку «ОК».

Теперь откроется новое окно, сообщающее, что вы добились успеха. Нажмите кнопку «ОК».

Когда вы вернетесь в окно управления ключами Enigmail, вы заметите изменение вашего ключа PGP. Теперь он выделен серым цветом и курсивом.

![image](tool_pgplin32.png)

**б) отзыв ключа PGP с отзывом сертификата**

Как упоминалось ранее, срок действия ключей PGP, сгенерированных Enigmail, автоматически истекает через пять лет. Поэтому, если вы потеряете все свои файлы, вы можете быть уверены, что люди будут знать, чтобы попросить вас другой ключ, как только срок действия ключа истечет.

Как мы уже упоминали ранее, у вас может быть веская причина отключить ключ PGP до его истечения.

Точно так же у других могут быть веские причины для отзыва существующего ключа.

Вы можете получить отзыв сертификата от друзей в качестве уведомления о том, что они хотят отозвать свой ключ.

В предыдущем разделе вы могли заметить, что Enigmail генерирует и импортирует сертификат отзыва внутренне, когда вы используете Enigmail Key Manager для отзыва ключа. Поскольку у вас уже есть сертификат отзыва, вы будете использовать тот, который вы сгенерировали ранее, чтобы отозвать свой собственный ключ.

Начните с Enigmail Key Manager, откройте меню «Файл» и выберите «Импортировать ключи из файла». 

![image](tool_pgplin33.png)

Откроется окно, в котором вы сможете выбрать сертификат отзыва. Нажмите на файл и нажмите кнопку «Открыть». Вы получите уведомление о том, что сертификат был успешно импортирован и ключ был отозван. Нажмите кнопку «ОК»

![image](tool_pgplin34.png)

Как только вы нажмете кнопку «ОК», вы вернетесь в Менеджер ключей Enigmail и увидите, что сертификат, который вы отозвали, выделен серым и курсивом. 

![image](tool_pgplin35.png)

Если ключ, который вы отозвали, принадлежит вам, и вы ранее загрузили свой открытый ключ на сервер ключей, вам нужно будет повторно загрузить теперь отозванный ключ на сервер ключей, чтобы другие больше не использовали его.

Теперь, когда у вас есть все необходимые инструменты, попробуйте отправить собственное электронное письмо, зашифрованное PGP.
